<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
  xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.9.xsd">


  <changeSet id="202404301614-1" author="kflahert" dbms="postgresql">
    <comment>
      Delete duplicate azure subscription entries that are missing billing_provider.
    </comment>
    <sql>
        delete from subscription invalidSubscription using subscription validSubscription where invalidSubscription.subscription_number = validSubscription.subscription_number and invalidSubscription.start_date != validSubscription.start_date and validSubscription.billing_provider='azure' and invalidSubscription.billing_provider is null
    </sql>
  </changeSet>

  <changeSet id="202404301614-2" author="kflahert">
    <comment>Delete testing subscriptions for Azure</comment>
    <delete tableName="subscription">
      <where>org_id = '17691289' and sku = 'RH02781HR'</where>
    </delete>
  </changeSet>

</databaseChangeLog>
